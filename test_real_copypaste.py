#!/usr/bin/env python3
"""
Тест для проверки реального копипаста
"""
import sys
from pathlib import Path

# Добавляем src в PYTHONPATH
current_dir = Path(__file__).parent
src_dir = current_dir / "src"
sys.path.insert(0, str(src_dir))

from models import Message
from submit.filters.message_cleaner import is_copy_paste_content


def test_real_copypaste():
    """Тестирует реальный копипаст из промпта"""
    print("Тестируем реальный копипаст из промпта...")
    
    # Текст из промпта, который должен быть отфильтрован
    copypaste_text = """напиши коротенько, о чём этот текст: Что нужно автомобилю В-класса, чтобы стать популярным? Ответ очевиден: как можно реже ломаться и радовать своего владельца минимальной стоимостью обслуживания. В своё время этим подкупал Renault Logan первого поколения, потом герои сменились – появились Hyundai Solaris и Kia Rio, которые могли порадовать ещё и приличными автоматами и даже неплохими комплектациями. Правда, многие считают, что эти автомобили одноразовые и сделаны без особого запаса прочности. Так ли это на самом деле? Может быть, просто надо их лучше обслуживать? И с чем можно столкнуться при эксплуатации подержанного бюджетного «корейца»? Давайте возьмём Киа Рио третьего поколения и постараемся ответить на все поставленные вопросы.

История техники
Первые серийные Rio появились в 2000-м году. Кузовов у первого поколения было было два, и если с седаном всё понятно, то со вторым кузовом до сих не могут определиться: то ли это был такой маленький универсал, то ли слишком большой хетчбэк. Выход этого автомобиля был серьёзной заявкой для всего мира: дизайном занимались сразу в двух отделениях компании (европейском и японском), но при этом очень хотели завоевать американский рынок. И нужно отметить, что к реализации планов в Киа подошли ответственно: гамма моторов для американского рынка отличалась от той, что предлагали в остальном мире (в США не пытались продавать машины с самыми маленькими моторами объёмом 1,3 л – только 1,5 и 1,6), а базовое оснащение было довольно богатым (ГУР, кондиционер, центральный замок с дистанционным управлением, передние стеклоподъёмники, электрозеркала, водительская подушка безопасности). А за деньги можно было докупить ещё и ABS с электронным распределением тормозных усилий, и люк, и даже CD-чейнджер. Ну и, конечно же, можно было купить машину с АКП.

Чего не хватило этому автомобилю, так это хотя бы мало-мальски интересного дизайна. И Рио второго поколения, вышедший в 2005-м году, постарались сделать привлекательнее. Моторы этой генерации, построенной на платформе JB Hyundai-Kia, остались довольно скромными (бензиновые 1,4 л и 1,6 и дизель 1,5 л), зато дизайн рестайлинга в 2010-м году рисовал сам Петер Шрайер (который в своё время создал, например, Audi TT, VW Passat B5, VW Golf IV, Audi A6 C5). Машина получилась довольно удачной, а в России – ещё и популярной в силу того, что с 2010 года её собирали на Автоторе.


Kia Rio I

Kia Rio II
Но всё же самый громкий успех ждал третье поколение, которое появилось в 2011 году. Для В-класса эта Рио была и достаточно симпатичной внешне, и далеко не бедной внутри (правда, только в самой топовой комплектации). При этом технически оставалась весьма скромной: у нас на ней могли стоять только два мотора (1,4 и 1,6 л), МКП или автомат (четырёхступенчатый до рестайлинга, и шестиступенчатый – после). Этот автомобиль с 15 августа 2011 года тоже собирали в России, на заводе Hyundai в Санкт-Петербурге. И это был настоящий успех: наряду с Солярисом Рио стал настоящим бестселлером. И, скорее всего, для этого были свои объективные причины. О них поговорим чуть ниже, а пока познакомимся с автомобилем, на котором поедем в сервис.


Реклама
Наша машина выпущена в 2012 году (значит, до рестайлинга). Её пробег 113 тыс. км, мотор – 1,6 (123 л.с.), четырёхступенчатая АКП и средняя комплектация без климата и бесключевого доступа, но со всем самым необходимым (все стеклоподъёмники, кондиционер, электрозеркала с обогревом, фронтальные подушки, обогрев зоны покоя дворников, водительское сиденье с лифтом, обогрев передних сидений, AUX, USB). Как я уже говорил, технически эта Киа очень близка Солярису, так что многое, о чём будем говорить дальше, пригодится и владельцем Солярисов.

Начнём с самого очевидного: во сколько обойдётся регламентное ТО с заменой масла с фильтром, воздушного и салонного фильтров. Но тут надо сделать важное замечание.


Осматривать машину мы будем в хорошем сетевом автосервисе Fit Service. За основу стоимости работ и деталей возьмём расчёты этого сервиса. Разу Как часто менять масло в Kia Rio III? Какой расход топлива у Kia Rio III? Какой клиренс у Kia Rio III? Какие слабые места у Kia Rio III? Сколько прослужит Kia Rio III при должном уходе и заботе? думаю вот машину сменить, сейчас у меня Chevrolet Cruze, а до этого была Renault Logan, думаю вот насчет Kia мой друг Андрюха себе вообще Мерс взял, ну это, конечно, баловство блин, я слесарем-электриком работаю в Московском метрополитене, на кой мне мерс ну Ладу я себе ни за что не возьму, ведро с гайками Какие бюджетные авто самые надёжные?"""
    
    print(f"Длина текста: {len(copypaste_text)} символов")
    print(f"Первые 200 символов: {copypaste_text[:200]}...")
    print()
    
    # Проверяем, определяется ли как копипаст
    is_copypaste = is_copy_paste_content(copypaste_text)
    print(f"Определяется как копипаст: {is_copypaste}")
    
    # Проверяем отдельные части
    parts = copypaste_text.split('\n\n')
    print(f"\nКоличество частей: {len(parts)}")
    
    for i, part in enumerate(parts[:3]):  # Проверяем первые 3 части
        print(f"\nЧасть {i+1} (длина: {len(part)}):")
        print(f"  Первые 100 символов: {part[:100]}...")
        is_copypaste_part = is_copy_paste_content(part)
        print(f"  Копипаст: {is_copypaste_part}")


if __name__ == "__main__":
    test_real_copypaste()